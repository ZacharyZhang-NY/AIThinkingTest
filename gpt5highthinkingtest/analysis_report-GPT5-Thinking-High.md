# 非线性单摆周期误差分析

本报告比较三种方法：小角近似、改进级数近似、Simpson 数值积分。参数：L=1.0 m，g=9.80665 m/s^2，θ0∈[5°,60°]，共12点，Simpson 步数=2000。

## 背景
理想单摆在有限振幅下周期随振幅增大而变长，小角近似仅在θ0较小时有效。

## 公式
- 小角近似：T0 = 2π√(L/g)
- 改进级数：T_series(θ0) = T0·(1 + θ0^2/16 + 11θ0^4/3072)
- 数值真值：T_num(θ0) = 4√(L/g)·∫_0^{θ0} dθ / √(2(cosθ − cosθ0))

## 数值积分方法与稳定性
- 使用 Simpson 法，区间[0,θ0]等分为N=2000(偶数)子区间。
- 被积函数对 θ=θ0 处可积奇异，采用稳健处理：将分母中的(cosθ−cosθ0)以max(·, ε)钳制，ε=1e−10。
- 该处理在上端点引入极小正则化，随步长与ε减小而减弱。

## 结果表
列：θ0[deg], T0[s], T_series[s], T_num[s], err_small, err_series

θ0(deg) | T0(s) | T_series(s) | T_num(s) | err_small | err_series
-|-|-|-|-|-
5.000 | 2.00640929 | 2.00736469 | 3.29558030 | 3.911818e-01 | 3.908919e-01
10.000 | 2.00640929 | 2.01023588 | 4.61205631 | 5.649643e-01 | 5.641346e-01
15.000 | 2.00640929 | 2.01503786 | 5.93043052 | 6.616756e-01 | 6.602206e-01
20.000 | 2.00640929 | 2.02179564 | 7.25072779 | 7.232817e-01 | 7.211596e-01
25.000 | 2.00640929 | 2.03054421 | 8.57298348 | 7.659614e-01 | 7.631461e-01
30.000 | 2.00640929 | 2.04132856 | 9.89724398 | 7.972760e-01 | 7.937478e-01
35.000 | 2.00640929 | 2.05420371 | 11.22356741 | 8.212325e-01 | 8.169741e-01
40.000 | 2.00640929 | 2.06923465 | 12.55202462 | 8.401525e-01 | 8.351473e-01
45.000 | 2.00640929 | 2.08649637 | 13.88270035 | 8.554741e-01 | 8.497053e-01
50.000 | 2.00640929 | 2.10607388 | 15.21569472 | 8.681355e-01 | 8.615854e-01
55.000 | 2.00640929 | 2.12806218 | 16.55112505 | 8.787751e-01 | 8.714249e-01
60.000 | 2.00640929 | 2.15256625 | 17.88912812 | 8.878420e-01 | 8.796718e-01

## 结果分析与结论
- 随 θ0 增大，T_num 增加；小角近似误差单调增大。
- 级数近似显著减小误差，在中等角度仍保持较好精度。
- 综合本次参数与数值：小角近似在 θ0 ≲ 20° 可靠；级数近似在 θ0 ≲ 45° 仍可接受。

## 适用范围与局限
- 适用范围：理想无阻尼单摆，L=常数，g=常数。
- 局限：级数存在截断误差；数值积分对ε与步长敏感，端点奇异需正则化；极大角度(接近π)时误差增大。

## 复现步骤
1) 设定 L, g, θ_low, θ_high, sample_count, integral_steps, ε；
2) 生成 θ0 等距网格(度)并转弧度；
3) 计算 T0 与 T_series；
4) 对每个 θ0 用 Simpson 法积分得到 T_num；
5) 计算相对误差并输出 data.json 与本报告。
