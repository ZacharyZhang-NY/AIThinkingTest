# 非线性单摆周期误差分析报告

## 1. 背景

单摆是经典力学中的重要模型。对于小振幅摆动（θ ≪ 1），其运动可近似为简谐振动，周期为 $T_0 = 2π\sqrt{L/g}$。对于大振幅，非线性效应显著，周期随振幅增大而增加。

精确的运动方程（无阻尼）：
$$\ddot{\theta} + \frac{g}{L}\sin\theta = 0$$

## 2. 近似方法

### 2.1 小角近似
将 $\sin\theta \approx \theta$ 线性化，得到周期：
$$T_0 = 2π\sqrt{\frac{L}{g}}$$
对所有振幅使用该固定值，未考虑非线性效应。

### 2.2 改进级数近似
将精确周期展开为傅里叶级数（保留到 $θ₀⁴$ 项）：
$$T_{series}(\theta_0) = T_0 \left(1 + \frac{\theta_0^2}{16} + \frac{11\theta_0^4}{3072} + \cdots\right)$$
该级数由精确解泰勒展开得到，为振幅提供高阶修正。

**截断误差**：保留至 $θ₀⁴$ 项，忽略了 $θ₀⁶$ 及更高阶项，会在大角度引入微小误差。

### 2.3 数值积分真值
精确周期通过椭圆积分表达。采用标准变换：
$$\sin\frac{\theta}{2} = \sin\frac{\theta_0}{2} \cdot \sin\phi$$

得到第一类完全椭圆积分形式：
$$T(\theta_0) = 4\sqrt{\frac{L}{g}} \int_0^{π/2} \frac{d\phi}{\sqrt{1 - k^2\sin^2\phi}}$$

其中 $k = \sin(\theta_0/2)$ 为椭圆积分模数。

**数值方法**：使用 Simpson 方法（2000步）计算该积分，数值误差约 $10^{-9}$。

## 3. 参数与计算

**系统参数**：
- 摆长 L = 1.0 m
- 重力加速度 g = 9.80665 m/s²
- 角度范围：θ₀ ∈ [5°, 60°]
- 采样点数：12（等间距）

**基准周期**：
$$T_0 = 2π\sqrt{\frac{1.0}{9.80665}} = 2.0064092926\ \text{s}$$

## 4. 结果分析

### 4.1 数据表格

| θ₀ (°) | T₀ (s) | T_series (s) | T_num (s) | err_small | err_series | diff(Ts-Tn) |
|--------|--------|--------------|-----------|-----------|------------|-------------|
| 5.0   | 2.00640929 | 2.0073646893 | **2.0073646895** | 0.05% | 0.00% | 2.08×10⁻¹⁰ |
| 10.0  | 2.00640929 | 2.0102358793 | **2.0102358926** | 0.19% | 0.00% | 1.33×10⁻⁸ |
| 15.0  | 2.00640929 | 2.0150378623 | **2.0150380146** | 0.43% | 0.00% | 1.52×10⁻⁷ |
| 20.0  | 2.00640929 | 2.0217956378 | **2.0217964972** | 0.76% | 0.00% | 8.59×10⁻⁷ |
| 25.0  | 2.00640929 | 2.0305442051 | **2.0305475005** | 1.19% | 0.00% | 3.30×10⁻⁶ |
| 30.0  | 2.00640929 | 2.0413285635 | **2.0413384659** | 1.71% | 0.00% | 9.90×10⁻⁶ |
| 35.0  | 2.00640929 | 2.0542037119 | **2.0542288706** | 2.33% | 0.00% | 2.52×10⁻⁵ |
| 40.0  | 2.00640929 | 2.0692346489 | **2.0692912014** | 3.04% | 0.00% | 5.66×10⁻⁵ |
| 45.0  | 2.00640929 | 2.0864963733 | **2.0866121798** | 3.84% | 0.01% | 1.16×10⁻⁴ |
| 50.0  | 2.00640929 | 2.1060738833 | **2.1062942874** | 4.74% | 0.01% | 2.20×10⁻⁴ |
| 55.0  | 2.00640929 | 2.1280621773 | **2.1284576487** | 5.73% | 0.02% | 3.96×10⁻⁴ |
| 60.0  | 2.00640929 | 2.1525662530 | **2.1532423518** | 6.82% | 0.03% | 6.76×10⁻⁴ |

**数值合理性验证**：
- T_num(5°) = 2.007 s ≈ T₀（差异仅 0.05%）
- T_num(60°) = 2.153 s > T₀，符合物理规律（周期随振幅增大）
- T_num/T₀ 比值：1.00048（5°）→ 1.0732（60°），合理增长
- **diff(Ts-Tn)** 列显示 T_series 与 T_num 的微小差异，验证两者正确区分

### 4.2 关键发现

1. **周期振幅依赖性**：
   - 5° 时：T = 2.007 s（比 T₀ 大 0.05%）
   - 60° 时：T = 2.153 s（比 T₀ 大 7.32%）
   - 趋势：周期随振幅增大而增大，符合理论预期

2. **小角近似误差**：
   - θ₀ ≤ 10°：误差 < 0.2%
   - θ₀ ≤ 20°：误差 < 0.8%
   - θ₀ = 60°：误差达 6.82%

3. **改进级数近似精度**：
   - 全区间（5°-60°）平均误差仅 **0.01%**
   - 60° 时误差仅 **0.03%**，极其精确
   - **截断误差**（diff 列）随角度增大从 $10^{-10}$ 增至 $7×10^{-4}$，符合预期

4. **T_series 与 T_num 的差异**：
   - 两者差异虽小但非零，验证了数值积分独立计算
   - 差异随角度增大而增大，反映了级数截断误差
   - 在 60° 时差异 $6.8×10^{-4}$ s，导致 0.03% 的误差

5. **误差比**：
   在 60° 时，级数比小角近似精确 **227 倍**（误差比 6.82% / 0.03%）。

## 5. 误差来源分析

**小角近似误差**：源于线性化假设，忽略所有高阶项。

**级数近似误差**：
- 截断误差：忽略 $θ₀^6$ 及更高阶项
- 在 θ₀ = 60° 时，$θ₀^6$ 项量级约 $3×10^{-4}$

**数值积分误差**：
- 离散化误差：Simpson 方法 $O(h^4)$，约 $10^{-9}$
- 舍入误差：浮点数精度，约 $10^{-16}$

**T_series 与 T_num 的关系**：
理论上 $T_{series} = T{num} + O(θ₀^6)$，数值结果验证了这一关系。

## 6. 结论

- **小角近似**：仅在 θ₀ ≤ 20° 范围内可靠（误差 < 0.8%）；超出此范围需要修正
- **改进级数近似**（保留至 θ₀⁴ 项）：
  - 在 θ₀ ≤ 60° 全区间保持极高精度（误差 < 0.03%）
  - 是工程应用（如摆钟设计）的理想选择
  - 相比小角近似提升 2 个数量级精度
- **数值积分**：验证了级数近似的正确性，但计算成本高，适合理论验证

## 7. 验证与复现

### 验证要点
1. **T_series ≠ T_num**：两者有微小差异（$10^{-10}$ 到 $10^{-4}$）
2. **err_series ≠ 0**：从 0.00% 增至 0.03%
3. **diff 随角度增大**：验证截断误差主导
4. **T_num > T₀**：周期随振幅增大

### 复现方法

```bash
# 项目目录
cd kimik2thinkingtest

# 运行最终版计算
python3 pendulum.py

# 输出文件
# - data.json: 完整计算数据（含 diff_Tseries_Tnum）
# - summary.json: 统计摘要
# - analysis_report.md: 本报告（≤2页）
```

**可调参数**：
- `theta_low_deg`, `theta_high_deg`: 角度范围
- `sample_count`: 采样密度
- `integral_steps`: 积分精度（↑ 精度 ↑ 计算时间）

## 8. 程序实现说明

**关键实现**：
1. **T₀**: 直接公式 $2π√(L/g)$
2. **T_series**: 级数展开至 $θ₀^4$ 项
3. **T_num**: 数值积分计算第一类完全椭圆积分
   ```python
   k = sin(θ₀/2)  # 椭圆模数
   integral = ∫[0→π/2] dφ/√(1 - k²sin²φ)  # Simpson方法
   T_num = 4√(L/g) × integral
   ```

**数值稳定性**：
- 积分区间 [0, π/2] 无奇点
- Simpson 方法 2000 步确保高精度
- 浮点数双精度（~16位有效数字）

**输出说明**：
- `diff(Ts-Tn)`: T_series 与 T_num 的差异，反映截断误差
- `err_small`: 相对 T_num 的小角近似误差
- `err_series`: 相对 T_num 的级数近似误差
