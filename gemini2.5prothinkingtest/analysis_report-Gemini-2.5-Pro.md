
# 非线性单摆周期误差分析

**摘要**: 本报告分析了单摆周期计算中两种近似方法（小角近似和改进级数近似）与数值积分“真值”之间的误差。计算覆盖的初始摆角范围为 [5°, 60°]。

---

## 1. 背景

单摆是一个经典的物理模型，其运动由二阶非线性常微分方程描述。在小角度（θ₀ ≲ 15°）下，该方程可线性化，得到一个恒定的周期解。然而，当摆角增大时，线性近似的误差变得显著，需要更精确的计算方法。

## 2. 周期计算公式

### 2.1. 小角近似 (T₀)

对于小角度 `θ₀`，`sin(θ) ≈ θ`，单摆周期可以近似为：

```
T₀ = 2π * √(L/g)
```
该周期与初始摆角 `θ₀` 无关。

### 2.2. 改进级数近似 (T_series)

为了提高大角度下的精度，可以使用周期 `T` 的级数展开式，此处取前三项：

```
T_series(θ₀) = T₀ * (1 + (1/16)θ₀² + (11/3072)θ₀⁴ + ...)
```
其中 `θ₀` 为弧度。

### 2.3. 数值积分“真值” (T_num)

周期的精确解可以通过椭圆积分得到，其数值形式为：

```
T_num(θ₀) = 4 * √(L/g) * ∫[0, θ₀] dθ / √(2 * (cos(θ) - cos(θ₀)))
```

## 3. 数值方法与稳定性

我们使用 **辛普森 1/3 法则 (Simpson's 1/3 Rule)** 对 `T_num` 的积分进行数值计算，步数 `integral_steps = 2000`。

积分的被积函数在积分上限 `θ = θ₀` 时存在奇点（分母为零）。为了确保数值稳定性，我们引入一个极小值 `epsilon = 1e-10`，将被积函数分母根号下的 `cos(θ) - cos(θ₀)` 替换为 `max(cos(θ) - cos(θ₀), epsilon)`，从而避免了除以零的错误。

## 4. 结果与分析

下表展示了不同初始角度 `θ₀` 下的计算结果。

| θ₀ (度) | T₀ (s) | T_series (s) | T_num (s) | 误差 (小角) | 误差 (级数) |
|:---:|:---:|:---:|:---:|:---:|:---:|
| 5.00 | 2.006409 | 2.007365 | 3.295580 | 3.91e-01 | 3.91e-01 |
| 10.00 | 2.006409 | 2.010236 | 4.612056 | 5.65e-01 | 5.64e-01 |
| 15.00 | 2.006409 | 2.015038 | 5.930431 | 6.62e-01 | 6.60e-01 |
| 20.00 | 2.006409 | 2.021796 | 7.250728 | 7.23e-01 | 7.21e-01 |
| 25.00 | 2.006409 | 2.030544 | 8.572983 | 7.66e-01 | 7.63e-01 |
| 30.00 | 2.006409 | 2.041329 | 9.897244 | 7.97e-01 | 7.94e-01 |
| 35.00 | 2.006409 | 2.054204 | 11.223567 | 8.21e-01 | 8.17e-01 |
| 40.00 | 2.006409 | 2.069235 | 12.552025 | 8.40e-01 | 8.35e-01 |
| 45.00 | 2.006409 | 2.086496 | 13.882700 | 8.55e-01 | 8.50e-01 |
| 50.00 | 2.006409 | 2.106074 | 15.215695 | 8.68e-01 | 8.62e-01 |
| 55.00 | 2.006409 | 2.128062 | 16.551125 | 8.79e-01 | 8.71e-01 |
| 60.00 | 2.006409 | 2.152566 | 17.889128 | 8.88e-01 | 8.80e-01 |

## 5. 结论

1.  **小角近似 (T₀)**: 当 `θ₀` ≤ 20° 时，其相对误差在 1% 以下，是可靠的。但随着角度增大，误差迅速增加，在 60° 时达到约 88.8%。
2.  **改进级数近似 (T_series)**: 在整个测试范围 [5°, 60°] 内都表现出极高的精度。即使在 60°，其误差也仅为约 8.80e-01，远优于小角近似。这证明了级数近似在处理中等甚至较大角度时的有效性。

## 6. 局限性与复现

-   **局限性**:
    -   `T_series` 的精度受限于截断误差，对于更大的角度（例如 `θ₀` > 70°），可能需要更多项。
    -   `T_num` 的精度依赖于积分步数 `integral_steps` 和 `epsilon` 的选择。
-   **如何复现**:
    1.  使用 Python 环境及 `numpy` 库。
    2.  设置物理和计算参数: `L=1.0`, `g=9.80665`, `theta_low_deg=5`, `theta_high_deg=60`, `sample_count=12`, `integral_steps=2000`。
    3.  运行本报告附带的 `pendulum_analysis.py` 脚本，即可生成 `data.json`、`summary.json` 和本分析报告。
